from pydantic import Field

from .base_tool import BaseTool


class ExecuteBash(BaseTool):
    """Execute a shell command on a machine."""

    machine_ipaddr: str = Field(
        ...,
        description="The IP address of the machine on which execute the command",
        title="machine_ipaddr",
    )
    cmd: str = Field(..., description="The full bash command", title="cmd")

    def run(self, shell):
        try:
            return shell.execute_cmd(self.cmd)
        except Exception:
            return (
                "Before sending a remote command you need to set-up an SSH connection."
            )
